<!DOCTYPE html>
<html lang="en">
<head>
  <!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-SXJRZNVXCH"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-SXJRZNVXCH');
</script>
  
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reviews & Blog - Calming Currents Beauty Spa</title>
  <link href="https://fonts.googleapis.com/css2?family=Dancing+Script&family=Playfair+Display:wght@700&family=Montserrat:wght@400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="css/style.css">
</head>
<body>

<header>
  <div class="container header">
    <div class="logo">
  <img src="https://images.ctfassets.net/09muo917z9ra/5EhOAmkNph6p93Y75Ai807/e4c70ddfdb2631d7ab2caf885019732c/Gohn-s_bakery_studio.png" alt="Calming Currents Logo">
    </div>
    <nav>
      <ul class="nav-links">
        <li><a href="index.html">Home</a></li>
        <li><a href="services.html">Services</a></li>
        <li><a href="gallery.html">Gallery</a></li>
        <li><a href="blog.html" class="active">Reviews</a></li>
        <li><a href="contact.html">Contact</a></li>
      </ul>
    </nav>
  </div>
</header>
<!-- Blog Section Start -->
<section id="blog-section" style="padding:2rem; max-width:900px; margin:auto;">
  <h2 style="color:#d6336c; text-align:center;">Latest Blog Posts</h2>
  <div id="blog-container">
    <p style="text-align:center;">Loading blog posts...</p>
  </div>
</section>

<!-- Blog Structured Data Schema -->
<script type="application/ld+json" id="blog-schema">
{
  "@context": "https://schema.org",
  "@type": "Blog",
  "name": "Calming Currents Blog",
  "url": "https://calmingcurrentsbeautyspa.com/about",
  "description": "Expert beauty and wellness tips from Calming Currents Beauty Spa",
  "blogPost": []
}
</script>

<script>
  // Contentful credentials
  const SPACE_ID = "09muo917z9ra";
  const ACCESS_TOKEN = "Z2-ybwP2VOWRp1wNWpxaaAl0P8sekgACZD-QXYDFrdw";

  async function fetchBlogPosts() {
    const res = await fetch(`https://cdn.contentful.com/spaces/${SPACE_ID}/environments/master/entries?access_token=${ACCESS_TOKEN}&content_type=blogPost&order=-fields.publishedDate`);
    const data = await res.json();
    return data.items.map(item => ({
      title: item.fields.title,
      content: item.fields.content,
      date: item.fields.publishedDate,
      slug: item.fields.slug
    }));
  }

  async function renderBlogPosts() {
    const posts = await fetchBlogPosts();
    const container = document.getElementById("blog-container");
    const schema = document.getElementById("blog-schema");

    if(posts.length === 0) {
      container.innerHTML = "<p style='text-align:center;'>No blog posts available at the moment.</p>";
      return;
    }

    container.innerHTML = ""; // clear loading

    const schemaPosts = [];

    posts.forEach(post => {
      const postEl = document.createElement("article");
      postEl.style.borderBottom = "1px solid #ddd";
      postEl.style.padding = "1rem 0";
      // convert Contentful rich text → plain text

      const text = post.content.content
  .map(block => block.content?.map(c => c.value).join("") || "")
  .join(" ");

const excerptLength = 180;
const excerpt = text.length > excerptLength
  ? text.substring(0, excerptLength) + "..."
  : text;

      postEl.innerHTML = `
  <h3 style="margin:0 0 0.5rem; color:#0a3d62;">${post.title}</h3>
  <small>Published: ${new Date(post.date).toLocaleDateString()}</small>

  <p class="excerpt">${excerpt}</p>
  <p class="full-text" style="display:none;">${text}</p>

  ${text.length > excerptLength 
    ? `<button class="read-more" style="
        margin-top:0.5rem;
        background:none;
        border:none;
        color:#0a3d62;
        font-weight:600;
        cursor:pointer;
      ">Read More</button>`
    : ""}
`;
      container.appendChild(postEl);

      const btn = postEl.querySelector(".read-more");
if (btn) {
  btn.addEventListener("click", () => {
    const excerptP = postEl.querySelector(".excerpt");
    const fullP = postEl.querySelector(".full-text");

    const expanded = fullP.style.display === "block";

    excerptP.style.display = expanded ? "block" : "none";
    fullP.style.display = expanded ? "none" : "block";
    btn.textContent = expanded ? "Read More" : "Read Less";
  });
}

      // Add to schema
      schemaPosts.push({
        "@type": "BlogPosting",
        "headline": post.title,
        "datePublished": post.date,
        "url": `https://calmingcurrentsbeautyspa.com/about#${post.slug}`,
        "author": {
          "@type": "Person",
          "name": "Calming Currents Beauty Spa"
        },
        "description": text.substring(0, 150)
      });
    });

    // Update schema JSON
    const schemaJson = JSON.parse(schema.innerHTML);
    schemaJson.blogPost = schemaPosts;
    schema.innerHTML = JSON.stringify(schemaJson);
  }

  renderBlogPosts();
</script>
<!-- Blog Section End -->
<footer>
  <div class="container footer">
    <p>© 2026 Calming Currents Beauty Spa | Mobile Spa Services Are Available | 391 Main Avenue, Ferndale, Randburg</p>
    <p>WhatsApp: <a href="https://wa.me/0697507959">0697507959</a></p>
  </div>
</footer>

</body>
</html>
